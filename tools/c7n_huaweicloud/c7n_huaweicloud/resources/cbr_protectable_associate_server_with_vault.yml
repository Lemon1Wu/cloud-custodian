policies:
  - name: cbr_protectable_associate_server_with_vault
    resource: huaweicloud.cbr-protectable
    mode:
      type: cloudtrace
      xrole: fgs
      eg_agency: EG_TARGET_AGENCY
      enable_lts_log: true
      events:
        - source: "ECS.ecs"
          event: "createServer"
          ids: "resource_id"
    filters:
      - type: unassociated_server_with_vault
        legal_keys: ['backup_policy']
        legal_values: ['45Dd']
    actions:
      - type: associate_server_with_vault
        backup_policy_id: "a88a3421-f57e-49a4-b0ab-0ba334313b48"
        consistent_level: "crash_consistent"
        object_type: "server"
        protect_type: "backup"
        size: 100
        charging_mode: "post_paid"
        period_type: "year"
        period_num: 1
        is_auto_renew: true
        is_auto_pay: true
        name: "new_vault"